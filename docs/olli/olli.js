!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,(()=>(()=>{"use strict";var e={144:(e,t,r)=>{r.d(t,{Z:()=>l});var n=r(81),i=r.n(n),a=r(645),o=r.n(a)()(i());o.push([e.id,'.olli-vis ul[role="tree"] {\n  margin: 0;\n  padding: 0;\n  list-style: none;\n}\n\n.olli-vis ul[role="tree"] li {\n  margin: 0;\n  padding: 0;\n  list-style: none;\n}\n\n.olli-vis [role="treeitem"][aria-expanded="false"] + [role="group"] {\n  display: none;\n}\n\n.olli-vis [role="treeitem"][aria-expanded="true"] + [role="group"] {\n  display: block;\n}\n\n.olli-vis [role="treeitem"][aria-expanded="false"] > ul {\n  display: none;\n}\n\n.olli-vis [role="treeitem"][aria-expanded="true"] > ul {\n  display: block;\n}\n\n/* .olli-vis [role="treeitem"],\n.olli-vis [role="treeitem"] span {\n  width: 9em;\n  margin: 0;\n  padding: 0.125em;\n  display: block;\n} */\n\n/* disable default keyboard focus styling for treeitems\n   Keyboard focus is styled with the following CSS */\n.olli-vis :focus {\n  outline: 0;\n}\n\n.olli-vis .focus,\n.olli-vis  span.focus,\n.olli-vis  [aria-selected="true"] {\n  border-color: black;\n  background-color: #eee;\n}\n\n.olli-vis .hover,\n.olli-vis  span:hover {\n  background-color: #ddd;\n}\n',""]);const l=o},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",n=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),n&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),n&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,n,i,a){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(n)for(var l=0;l<this.length;l++){var s=this[l][0];null!=s&&(o[s]=!0)}for(var d=0;d<e.length;d++){var u=[].concat(e[d]);n&&o[u[0]]||(void 0!==a&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=a),r&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=r):u[2]=r),i&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=i):u[4]="".concat(i)),t.push(u))}},t}},81:e=>{e.exports=function(e){return e[1]}},379:e=>{var t=[];function r(e){for(var r=-1,n=0;n<t.length;n++)if(t[n].identifier===e){r=n;break}return r}function n(e,n){for(var a={},o=[],l=0;l<e.length;l++){var s=e[l],d=n.base?s[0]+n.base:s[0],u=a[d]||0,c="".concat(d," ").concat(u);a[d]=u+1;var f=r(c),p={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==f)t[f].references++,t[f].updater(p);else{var h=i(p,n);n.byIndex=l,t.splice(l,0,{identifier:c,updater:h,references:1})}o.push(c)}return o}function i(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,i){var a=n(e=e||[],i=i||{});return function(e){e=e||[];for(var o=0;o<a.length;o++){var l=r(a[o]);t[l].references--}for(var s=n(e,i),d=0;d<a.length;d++){var u=r(a[d]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}a=s}}},569:e=>{var t={};e.exports=function(e,r){var n=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,r)=>{e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var i=void 0!==r.layer;i&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,i&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var a=r.sourceMap;a&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={id:n,exports:{}};return e[n](a,a.exports,r),a.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nc=void 0;var n={};return(()=>{r.r(n),r.d(n,{chart:()=>ie,facetedChart:()=>ae,olli:()=>oe});var e,t=function(){return t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},t.apply(this,arguments)},i=function(e){return e instanceof Date?e.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"}):"string"==typeof e||isNaN(e)||e%1==0?String(e):Number(e).toFixed(2)},a=function(){return window._olli||(window._olli={}),window._olli},o=function(e){window._olli=t(t({},window._olli),e)},l=function(){function e(e,t,r){e.tabIndex=-1,this.tree=t,this.domNode=e,this.isExpandable=!1,this.isVisible=!1,this.inGroup=!1,r&&(this.inGroup=!0),this.parent=r,this.children=[];for(var n=e.firstElementChild;n;){if(["ul","table","thead","tbody","tr","td","th"].includes(n.tagName.toLowerCase())){this.isExpandable=!0;break}n=n.nextElementSibling}this.keyCode=Object.freeze({RETURN:13,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,X:88,Y:89,L:76,G:71,W:87,A:65,S:83,D:68,ESCAPE:27,PLUS:107,MINUS:189})}return e.prototype.init=function(){this.domNode.tabIndex=-1,this.domNode.addEventListener("keydown",this.handleKeydown.bind(this)),this.domNode.addEventListener("click",this.handleClick.bind(this)),this.domNode.addEventListener("focus",this.handleFocus.bind(this)),this.domNode.addEventListener("blur",this.handleBlur.bind(this)),this.isExpandable||(this.domNode.addEventListener("mouseover",this.handleMouseOver.bind(this)),this.domNode.addEventListener("mouseout",this.handleMouseOut.bind(this)))},e.prototype.isExpanded=function(){return!!this.isExpandable&&"true"===this.domNode.getAttribute("aria-expanded")},e.prototype.handleKeydown=function(e){e.altKey||e.ctrlKey||e.metaKey||this.checkBaseKeys(e)},e.prototype.checkBaseKeys=function(e){var t=!1,r=this.tree.currentlyTypingToken();switch(e.key){case"Enter":case" ":this.isExpandable&&(this.isExpanded()?this.tree.collapseTreeItem(this):this.tree.expandTreeItem(this)),t=!0;break;case"ArrowDown":this.children.length>0&&this.isExpandable&&(this.tree.expandTreeItem(this),this.tree.setFocusToNextLayer(this)),t=!0;break;case"Escape":case"ArrowUp":this.inGroup&&(this.tree.setFocusToParentItem(this),t=!0);break;case"ArrowLeft":this.tree.setFocusToPreviousItem(this),t=!0;break;case"ArrowRight":this.tree.setFocusToNextItem(this),t=!0;break;case"Home":this.parent&&(this.tree.setFocusToFirstInLayer(this),t=!0);break;case"End":this.parent&&(this.tree.setFocusToLastInLayer(this),t=!0);break;case"x":r||this.tree.focusOnNodeType("xAxis",this);break;case"y":r||this.tree.focusOnNodeType("yAxis",this);break;case"l":r||this.tree.focusOnNodeType("legend",this);break;case"w":r||this.tree.setFocusGridUp(this);break;case"a":r||this.tree.setFocusGridLeft(this);break;case"s":r||this.tree.setFocusGridDown(this);break;case"d":r||this.tree.setFocusGridRight(this)}t&&(e.stopPropagation(),e.preventDefault())},e.prototype.handleClick=function(e){this.isExpandable?(this.isExpanded()?this.tree.collapseTreeItem(this):this.tree.expandTreeItem(this),e.stopPropagation()):(this.tree.setFocusToItem(this),e.stopPropagation())},e.prototype.handleFocus=function(){var e=this.domNode;this.isExpandable&&(e=e.firstElementChild),e.classList.add("focus")},e.prototype.handleBlur=function(){var e=this.domNode;this.isExpandable&&(e=e.firstElementChild),e.classList.remove("focus")},e.prototype.handleMouseOver=function(e){e.currentTarget.classList.add("hover")},e.prototype.handleMouseOut=function(e){e.currentTarget.classList.remove("hover")},e}(),s=function(){function e(e,t){this.currentlyTypingToken=function(){if(document.activeElement&&(document.activeElement.id.endsWith("custom-name")||"command-dropdown"===document.activeElement.id))return!0},this.domNode=e,this.treeItems=[],this.onFocus=t}return e.prototype.init=function(){!function e(t,r,n){for(var i=t.firstElementChild,a=n;i;)["li","table","tr","th","td"].includes(i.tagName.toLowerCase())&&((a=new l(i,r,n)).init(),n&&n.children.push(a),r.treeItems.push(a)),i.firstElementChild&&e(i,r,a),i=i.nextElementSibling}(this.domNode,this,void 0),this.updateVisibleTreeItems(),this.rootTreeItem.domNode.tabIndex=0,this.lastFocusedItem=this.rootTreeItem},e.prototype.setFocusToItem=function(e){for(var t=0;t<this.treeItems.length;t++){var r=this.treeItems[t];r===e?(r.domNode.tabIndex=0,r.domNode.focus(),r.domNode.setAttribute("aria-selected","true"),this.lastFocusedItem=r,this.onFocus&&this.onFocus(r.domNode),o({lastVisitedTree:this})):(r.domNode.tabIndex=-1,r.domNode.setAttribute("aria-selected","false"))}},e.prototype.setFocusToNextItem=function(e){if(e.parent){var t=e.parent.children.indexOf(e);t<e.parent.children.length-1&&this.setFocusToItem(e.parent.children[t+1])}},e.prototype.setFocusToPreviousItem=function(e){if(e.parent){var t=e.parent.children.indexOf(e);t>0&&this.setFocusToItem(e.parent.children[t-1])}},e.prototype.setFocusToNextLayer=function(e){e.lastVisitedChild?this.setFocusToItem(e.lastVisitedChild):this.setFocusToItem(e.children[0])},e.prototype.setFocusToParentItem=function(e){e.parent&&(e.parent.lastVisitedChild=e,this.setFocusToItem(e.parent),e.parent.isExpandable&&e.parent.isExpanded()&&this.collapseTreeItem(e.parent))},e.prototype.setFocusToFirstInLayer=function(e){e.parent&&this.setFocusToItem(e.parent.children[0])},e.prototype.setFocusToLastInLayer=function(e){e.parent&&this.setFocusToItem(e.parent.children[e.parent.children.length-1])},e.prototype.setFocusGridLeft=function(e){var t=e.domNode.getAttribute("data-i"),r=e.domNode.getAttribute("data-j");if(t&&r){var n=this.treeItems.find((function(e){return e.domNode.getAttribute("data-i")===String(Number(t)-1)&&e.domNode.getAttribute("data-j")===String(r)}));n&&this.setFocusToItem(n)}},e.prototype.setFocusGridRight=function(e){var t=e.domNode.getAttribute("data-i"),r=e.domNode.getAttribute("data-j");if(t&&r){var n=this.treeItems.find((function(e){return e.domNode.getAttribute("data-i")===String(Number(t)+1)&&e.domNode.getAttribute("data-j")===String(r)}));n&&this.setFocusToItem(n)}},e.prototype.setFocusGridUp=function(e){var t=e.domNode.getAttribute("data-i"),r=e.domNode.getAttribute("data-j");if(t&&r){var n=this.treeItems.find((function(e){return e.domNode.getAttribute("data-i")===String(t)&&e.domNode.getAttribute("data-j")===String(Number(r)+1)}));n&&this.setFocusToItem(n)}},e.prototype.setFocusGridDown=function(e){var t=e.domNode.getAttribute("data-i"),r=e.domNode.getAttribute("data-j");if(t&&r){var n=this.treeItems.find((function(e){return e.domNode.getAttribute("data-i")===String(t)&&e.domNode.getAttribute("data-j")===String(Number(r)-1)}));n&&this.setFocusToItem(n)}},e.prototype.expandTreeItem=function(e){e.isExpandable&&(e.parent&&e.parent.children.forEach((function(t){t!==e&&t.domNode.setAttribute("aria-expanded","false")})),e.domNode.setAttribute("aria-expanded","true"),this.updateVisibleTreeItems())},e.prototype.collapseTreeItem=function(e){var t;e.isExpanded()?t=e:e.parent&&(t=e.parent),t&&(t.domNode.setAttribute("aria-expanded","false"),this.updateVisibleTreeItems(),this.setFocusToItem(t))},e.prototype.updateVisibleTreeItems=function(){this.rootTreeItem=this.treeItems[0];for(var e=0;e<this.treeItems.length;e++){var t=this.treeItems[e],r=t.domNode.parentNode;for(t.isVisible=!0;r&&r!==this.domNode;)"false"==r.getAttribute("aria-expanded")&&(t.isVisible=!1),r=r.parentNode}},e.prototype.focusOnNodeType=function(e,t){for(var r=this,n=function(e){e&&e.isExpandable&&!e.isExpanded()&&(r.expandTreeItem(e),n(e.parent))},i=function(e){e.children.forEach((function(e){e.isExpandable&&e.isExpanded()&&(i(e),r.collapseTreeItem(e))}))},a=t.domNode.getAttribute("data-nodetype"),o=t;"chart"!==a;){if(!a)return;if(!o.parent)return;a=(o=o.parent).domNode.getAttribute("data-nodetype")}var l=o.children.find((function(t){var r=t.domNode.getAttribute("data-nodetype");return e===r}));l&&(n(l),i(l),this.setFocusToItem(l))},e}(),d=["name","index","type","children","data","size","facet","aggregate","quantile"],u=["root","facet","axis","section","datapoint"];!function(e){e[e.Short=0]="Short",e[e.Long=1]="Long"}(e||(e={}));var c={multiView:"root",chart:"facet",xAxis:"axis",yAxis:"axis",legend:"axis",grid:"axis",filteredData:"section",data:"datapoint"},f={root:["name"],facet:["index","type","name","children"],axis:["name","type","data","size","facet","aggregate"],section:["data","index","size","facet","aggregate","quantile"],datapoint:["data","facet","quantile"]},p=e.Short,h=e.Long,m={index:'Index in set (e.g. "1 of 5 ")',type:'Type of element (e.g. "temporal scale", "line chart")',size:'Size of children (e.g. "10 values")',data:'Data value or range (e.g. "0 to 800 ", "price: 50 ")',aggregate:'Aggregate statistics including minimum, maximum, and average (e.g. "average: 50 ")',facet:'Facet name (e.g. "profit" and "expenditures")',name:'Name (e.g. "x-axis titled price")',children:'Children’s names (e.g. at the root, "axes titled date and price") ',quantile:'Quantile of current data (e.g. "quartile: 1 ")'},v={facet:{high:[["index",h],["type",h],["name",h],["children",h]],medium:[["type",h],["name",h],["children",h]],low:[["type",p],["name",p],["children",p]]},axis:{high:[["name",h],["type",h],["data",h],["size",h],["facet",h],["aggregate",h]],medium:[["name",h],["type",h],["data",h]],low:[["name",p],["type",p],["data",p]]},section:{high:[["data",h],["index",h],["size",h],["facet",h],["aggregate",h],["quantile",h]],medium:[["data",h],["size",h]],low:[["data",p],["size",p]]},datapoint:{high:[["data",h],["facet",h],["quantile",h]],medium:[["data",h]],low:[["data",p]]}},y=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function g(e){console.log("speaking:",e);var t=document.createElement("div");t.setAttribute("aria-live","assertive"),document.body.appendChild(t),window.setTimeout((function(){t.innerText=e}),100),window.setTimeout((function(){t.remove()}),1e3)}var b=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},x=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o};function E(e,t){var r,n,i=JSON.parse(localStorage.getItem("settingsData"))[e],a=document.createElement("select");a.id=e+"-verbosity",a.addEventListener("change",(function(e){w(a,t)}));var o=document.createElement("label");o.setAttribute("for",e+"-verbosity"),o.innerText=S(e+" verbosity:");var l=document.createElement("span");l.setAttribute("tabindex","0"),l.innerText="Description: "+I(i[Object.keys(i)[0]]);try{for(var s=b(Object.keys(i)),d=s.next();!d.done;d=s.next()){var u=d.value,c=document.createElement("option");c.innerText=u,c.value=u,a.appendChild(c)}}catch(e){r={error:e}}finally{try{d&&!d.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}var f=document.createElement("option");f.innerText="custom",f.value="custom",a.appendChild(f),a.addEventListener("change",(function(e){"custom"!==a.value?g(a.id.split("-")[0]+" verbosity set to "+a.value):g("Custom menu open")}));var p=document.createElement("div");return p.id=e+"-verbosity-container",p.appendChild(o),p.appendChild(a),p.append(l),p}function w(e,t){var r=JSON.parse(localStorage.getItem("settingsData")),n=e.id.split("-")[0],i=document.getElementById(n+"-custom"),a=e.nextElementSibling;"custom"===e.value?(i.setAttribute("style","display: block"),i.setAttribute("aria-hidden","false"),a.innerText="Create a custom preset using the preset menu. Set verbosity for each element; use alt/option-left and alt/option-right to reorder elements."):(i.setAttribute("style","display: none"),i.setAttribute("aria-hidden","true"),a.innerText="Description: "+I(r[n][e.value]),J(t,document.getElementById("tree-root")))}function A(t){var r,n,i=[];try{for(var a=b(document.getElementById(t+"-custom-options").children),o=a.next();!o.done;o=a.next()){var l=o.value.firstElementChild;"long"===l.value?i.push([l.id.split("-")[1],e.Long]):"short"===l.value&&i.push([l.id.split("-")[1],e.Short])}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return i}var T=Object.fromEntries(d.map((function(e){return[e,!1]})));function N(t,r){var n,i;void 0===r&&(r=void 0);var a,o=c[t.type],l={},s=JSON.parse(localStorage.getItem("settingsData"));if("root"===o)a=f[o],l=Object.fromEntries(a.map((function(t){return[t,e.Long]})));else{var d=document.getElementById(o+"-verbosity"),u=d?d.value:"high";a=s[o][u].map((function(e){return e[0]})),l=Object.fromEntries(s[o][u])}var p=[];try{for(var h=b(t.description.entries()),m=h.next();!m.done;m=h.next()){var v=x(m.value,2),y=v[0],g=v[1];if(a.includes(y)||T[y]){var E=0;r?E=Number(Object.values(e).find((function(t){return"number"==typeof t&&e[t]===r}))):l[y]&&(E=l[y]),T[y]?p.unshift(g[E]):p[a.indexOf(y)]=g[E]}}}catch(e){n={error:e}}finally{try{m&&!m.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}return function(e){return e.filter((function(e){return e.length>0})).map(S).join(". ")+"."}(p)}function S(e){return e.slice(0,1).toUpperCase()+e.slice(1)}function I(t){var r,n,i="";try{for(var a=b(t),o=a.next();!o.done;o=a.next()){var l=x(o.value,2),s=l[0],d=l[1];i+=s+" ("+e[d]+"), "}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return i.slice(0,-2)}var k=r(379),C=r.n(k),F=r(795),O=r.n(F),L=r(569),j=r.n(L),D=r(565),K=r.n(D),M=r(216),P=r.n(M),V=r(589),q=r.n(V),B=r(144),U={};U.styleTagTransform=q(),U.setAttributes=K(),U.insert=j().bind(null,"head"),U.domAPI=O(),U.insertStyleElement=P(),C()(B.Z,U),B.Z&&B.Z.locals&&B.Z.locals;var G=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},z=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o};function J(e,t){var r,n;if(t.children.length)try{for(var i=G(t.children),a=i.next();!a.done;a=i.next()){var o=a.value;if("TABLE"===o.nodeName){var l=t.parentElement,s=R(l,e).children.filter((function(e){return"data"===e.type}));o.replaceWith(_(s,l.id.split("-").length))}else o.firstElementChild.innerText=N(R(o,e)),o.children[1]&&J(e,o.children[1])}}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}}function R(e,t){var r,n,i=t.root,a=e.id.split("-").slice(2).map((function(e){return Number(e)}));try{for(var o=G(a),l=o.next();!l.done;l=o.next()){var s=l.value;i=i.children[s]}}catch(e){r={error:e}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i}function _(e,t){var r,n,a=function(){var e,t,r=JSON.parse(localStorage.getItem("settingsData")),n=document.getElementById("datapoint-verbosity"),i=n?n.value:"high",a=r.datapoint[i].map((function(e){return e[0]})),o=r.datapoint.high.map((function(e){return e[0]})),l={};try{for(var s=b(o),d=s.next();!d.done;d=s.next()){var u=d.value;l[u]=a.indexOf(u)}}catch(t){e={error:t}}finally{try{d&&!d.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}return l}(),o=[],l=[];console.log("dtk",e[0].tableKeys,e[0].tableKeysMap),e[0].tableKeys.forEach((function(t,r){var n=e[0].tableKeysMap[r],i=a[n];console.log("ki",n,i),console.log("q",e[0].description.get("quantile")),i<0||("quantile"!=n||e[0].description.get("quantile")[0])&&(o.push(t),l.push(n))})),console.log("uo",o,l);var s=[],d=[];try{for(var u=G(Object.entries(a).sort((function(e,t){return e[1]-t[1]}))),c=u.next();!c.done;c=u.next()){var f=z(c.value,2),p=f[0],h=(f[1],l.indexOf(p));h<0||(d.push(p),s.push(o[h]),"data"===p&&(d.push(p),s.push(o[h+1])))}}catch(e){r={error:e}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}console.log("o",s,d);var m=document.createElement("table");m.setAttribute("aria-label","Table with "+e.length+" rows"),m.setAttribute("aria-level",String(t)),m.setAttribute("aria-posinset","1"),m.setAttribute("aria-setsize","1");var v=document.createElement("tbody"),y=document.createElement("thead"),g=document.createElement("tr");return g.setAttribute("aria-label",""+(null==s?void 0:s.join(", "))),null==s||s.forEach((function(e){var t=document.createElement("th");t.setAttribute("scope","col"),t.innerText=e,g.appendChild(t)})),y.appendChild(g),m.appendChild(y),e.forEach((function(e,t){var r,n=document.createElement("tr");n.setAttribute("aria-label",""+(null===(r=e.tableKeys)||void 0===r?void 0:r.map((function(t){return t+": "+i(e.selected[0][t])})).join(", "))),null==s||s.forEach((function(t,r){var a;a="quantile"===d[r]?e.description.get("quantile")[0]:i(e.selected[0][t]);var o=document.createElement("td");o.innerText=a,n.appendChild(o)})),v.appendChild(n)})),m.appendChild(v),m}var W=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o},H=function(e,t,r){if(r||2===arguments.length)for(var n,i=0,a=t.length;i<a;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},Z=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function X(e){var t=Y(e);switch(e.type){case"facetedChart":return{root:ee("multiView",e.selection||e.data,null,e,t),fieldsUsed:t};case"chart":return{root:ee("chart",e.selection||e.data,null,e,t),fieldsUsed:t};default:throw"olliVisSpec.type "+e.type+" not handled in olliVisSpecToTree"}}function Y(e){switch(e.type){case"facetedChart":return H([],W(new Set(H([e.facetedField],W(H([],W(e.charts.values()),!1).flatMap((function(e){return Y(e)}))),!1))),!1);case"chart":return H([],W(new Set(e.axes.concat(e.legends).reduce((function(e,t){return e.concat(t.field)}),[]))),!1);default:throw"olliVisSpec.type "+e.type+" not handled in getFieldsUsedForChart"}}var Q=function(e,t,r,n){return e.filter((function(e){var i=e[t];if(i instanceof Date){var a=String(r),o=String(n);4===a.length&&4===o.length&&(i=i.getFullYear())}return i>=r&&i<n}))};function $(e){var t=function(e){return e.every((function(e){return"string"==typeof e||e instanceof String}))?{values:e.map((function(e){return Number(e.replaceAll(",",""))}))}:e.every((function(e){return e instanceof Date}))?{values:e.map((function(e){return e.getTime()})),isDate:!0}:{values:e}}(e),r=t.values.reduce((function(e,t,r,n){var i,a=r-1;if(0===r&&0===t)return e;if(-1===a&&0!==t)i=[t-(n[r+1]-t),t];else if(r===n.length-1){var o=t+(t-n[r-1]);e.push([n[a],t]),i=[t,o]}else i=[n[a],n[a+1]];return e.push([i[0],i[1]]),e}),[]);return t.isDate?r.map((function(e){return[new Date(e[0]),new Date(e[1])]})):r}function ee(e,t,r,n,a,o,l,s,d,u,p){var h={type:e,parent:r,selected:t,filterValue:l,gridIndex:p,description:new Map,children:[]},m=n,v=n;switch(e){case"multiView":h.children=H([],W(m.charts.entries()),!1).map((function(e,r,n){var i=W(e,2),o=i[0],l=i[1];return ee("chart",t.filter((function(e){return String(e[m.facetedField])===o})),h,l,a,o,void 0,void 0,r,n.length)}));break;case"chart":var y=v.axes.filter((function(e){return"bar"!==v.mark||"continuous"!==e.type}));h.children=H(H(H([],W(y.map((function(e){return ee("x"===e.axisType?"xAxis":"yAxis",t,h,v,a,o,void 0,e)}))),!1),W(v.legends.map((function(e){return ee("legend",t,h,v,a,o,void 0,e)}))),!1),W("point"===v.mark&&2===y.length&&y.every((function(e){return"continuous"===e.type}))?[ee("grid",t,h,v,a,o)]:[]),!1);break;case"xAxis":case"yAxis":var g=s;switch(g.type){case"discrete":h.children=g.values.map((function(e,r){return ee("filteredData",t.filter((function(t){return String(t[g.field])===String(e)})),h,v,a,o,String(e),g,r,g.values.length)}));break;case"continuous":var b=$(g.values);h.children=b.map((function(e,r){var n=W(e,2),i=n[0],l=n[1];return ee("filteredData",Q(t,g.field,i,l),h,v,a,o,[i,l],g,r,b.length)}))}break;case"legend":var x=s;"discrete"===x.type&&(h.children=x.values.map((function(e,r){return ee("filteredData",t.filter((function(t){return String(t[x.field])===String(e)})),h,v,a,o,String(e),x,r,x.values.length)})));break;case"grid":var E=v.axes.find((function(e){return"x"===e.axisType})),w=v.axes.find((function(e){return"y"===e.axisType})),A=$(E.values),T=$(w.values);h.children=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce((function(e,t){return e.flatMap((function(e){return t.map((function(t){return[e,t].flat()}))}))}))}(A,T).map((function(e,r){var n=W(e,4),i=n[0],l=n[1],s=n[2],d=n[3];return ee("filteredData",Q(Q(t,E.field,i,l),w.field,s,d),h,v,a,o,[[i,l],[s,d]],void 0,void 0,void 0,{i:Math.floor(r/T.length),j:r%T.length})}));break;case"filteredData":h.children=t.map((function(e,t,r){return ee("data",[e],h,v,a,o,void 0,s,t,r.length)}));break;case"data":if(h.tableKeys=a,h.tableKeysMap=h.tableKeys.map((function(e){return"data"})),s&&(h.tableKeys=h.tableKeys.filter((function(e){return e!==s.field})).concat([s.field])),o){var N=a[0];h.tableKeys=h.tableKeys.filter((function(e){return e!==N})).concat([N]),h.tableKeysMap[h.tableKeys.length-1]="facet"}h.tableKeys.push("quartile"),h.tableKeysMap.push("quantile");break;default:throw"Node type "+e+" not handled in olliVisSpecToNode"}return h.description=function(e,t,r,n,a,o){return function(e,t,r,n,a,o){var l,s,d=function(e){return"point"===e.mark?e.axes.every((function(e){return"continuous"===e.type}))?"scatterplot":"dot plot":e.mark?e.mark+" chart":""},u=function(e){return e.title||r?'"'+(e.title||r)+'"':""},p=function(e){return'titled "'+(e.title||e.field)+'"'},h=function(e){return(e.scaleType||e.type)+" scale"},m=function(e,t,r){return void 0===r&&(r="s"),e+" "+t+(1!==e?r:"")},v=function(e){return e?Array.isArray(e)?""+e.map((function(e){return i(e)})).join(" to "):'"'+i(e)+'"':""},y=function(e,t){return i(e.reduce((function(e,r){return e+Number(r[t])}),0)/e.length)},g=t,b=n,x=n;var E={name:function(e){switch(e.type){case"multiView":var r=u(t);return["faceted chart "+r+", "+e.children.length+" views","a faceted chart "+(r.length>0?"titled "+r:r)+" with "+e.children.length+" views"];case"chart":return[r=u(t),r.length>0?"titled "+r:r];case"xAxis":case"yAxis":return Array(2).fill(b.axisType+"-axis "+p(b));case"legend":return Array(2).fill("legend "+p(x));case"grid":return["grid","grid view of "+d(g)];default:throw"Node type "+e.type+" does not have the token name."}},index:function(e){switch(e.type){case"chart":case"filteredData":return Array(2).fill(function(e,t){return void 0!==e&&void 0!==t?e+1+" of "+t:""}(a,o));default:throw"Node type "+e.type+" does not have the token index."}},type:function(e){switch(e.type){case"chart":return Array(2).fill(d(g));case"xAxis":case"yAxis":return[h(b),"for a "+h(b)];case"legend":return Array(2).fill(function(e){return e.channel?"for "+e.channel:""}(x));case"grid":return["",""];default:throw"Node type "+e.type+" does not have the token type."}},children:function(e){if("chart"===e.type){var t=g.axes[0].title||g.axes[0].field,r=g.axes.map((function(e){return'"'+(e.title||e.field)+'"'}));return 1===g.axes.length?["axis "+t,"with axis "+t]:["axes "+r.join(", "),"with axes "+r.join(" and ")]}throw"Node type "+e.type+" does not have the token children."},data:function(e){var t,r;switch(e.type){case"xAxis":case"yAxis":case"legend":var n=i(b.values[0]),a=i(b.values[1]),o=i(b.values[b.values.length-1]),l=m(b.values.length,"value");return"discrete"===b.type?2===b.values.length?["2 values: "+n+", "+a,'with 2 values: "'+n+'" and "'+a+'"']:[l+" from "+n+" to "+o,"with "+l+' starting with "'+n+'" and ending with "'+o+'"']:["from "+n+" to "+o,'with values from "'+n+'" to "'+o+'"'];case"grid":return["",""];case"filteredData":var s;return"grid"===(null===(t=e.parent)||void 0===t?void 0:t.type)?[(r=e.filterValue,s=r?v(r[0])+" and "+v(r[1]):""),"Values from "+s]:[s=v(e.filterValue),"Values from "+s];case"data":return Array(2).fill(function(e,t){var r;return null===(r=t.tableKeys)||void 0===r?void 0:r.map((function(t){return'"'+t+'": "'+i(e[t])+'"'})).join(", ")}(e.selected[0],e));default:throw"Node type "+e.type+" does not have the token data."}},size:function(e){switch(e.type){case"xAxis":case"yAxis":case"legend":case"grid":case"filteredData":return Array(2).fill(m(e.children.length,"value"));default:throw"Node type "+e.type+" does not have the token size."}},facet:function(e){switch(e.type){case"xAxis":case"yAxis":case"legend":case"grid":case"filteredData":case"data":var t=function(e){return e?""+e:""}(r);return[t,t.length>0?'"'+t+'"':t];default:throw"Node type "+e.type+" does not have the token parent."}},aggregate:function(e){switch(e.type){case"xAxis":case"yAxis":case"filteredData":var t=re(e);if(!t||!b||!e.selected.length)return["",""];var r=te(t,b);if(void 0===r)return["",""];var n=String(r),a=y(e.selected,n),o=function(e,t){return i(e.reduce((function(e,r){return Math.max(e,Number(r[t]))}),Number(e[0][t])))}(e.selected,n),l=function(e,t){return i(e.reduce((function(e,r){return Math.min(e,Number(r[t]))}),Number(e[0][t])))}(e.selected,n);return["average "+a+", maximum "+o+", minimum "+l,'the average for the "'+n+'" field is '+a+", the maximum is "+o+", and the minimum is "+l];case"legend":case"grid":return["",""];default:throw"Node type "+e.type+" does not have the token aggregate."}},quantile:function(e){switch(e.type){case"filteredData":var t=re(e);if(!(t&&b&&e.parent&&e.selected.length))return["",""];var r=te(t,b);if(void 0===r)return["",""];var i=String(r),a=void 0;switch(e.parent.type){case"xAxis":case"yAxis":var o=n;switch(o.type){case"discrete":a=o.values.map((function(t,r){return e.parent.selected.filter((function(e){return String(e[o.field])===String(t)}))}));break;case"continuous":a=$(o.values).map((function(t,r){var n=W(t,2),i=n[0],a=n[1];return Q(e.parent.selected,o.field,i,a)}))}break;case"legend":var l=n;switch(l.type){case"discrete":a=l.values.map((function(t,r){return e.parent.selected.filter((function(e){return String(e[l.field])===String(t)}))}));break;case"continuous":return["",""]}break;case"grid":return["",""]}if(!a)return["",""];var s=[];a.forEach((function(e){if(0!=e.length){var t=y(e,i);s.push(Number(t))}else s.push(0)})),s.sort((function(e,t){return e-t}));var d=0==e.selected.length?0:y(e.selected,i),u=s.indexOf(Number(d))/s.length,c=Math.max(1,Math.ceil(4*u));return["quartile "+c+" by average","quartile "+c+' when compared by section average over the "'+i+'" field'];case"data":if(!b)return["",""];if(void 0===(r=te(e,b)))return["",""];i=String(r),e.tableKeys[e.tableKeys.indexOf("quartile")]="quartile ("+i+")";var f=e.parent.selected.map((function(e){return e[i]}));f.sort((function(e,t){return Number(e)-Number(t)}));var p=f.indexOf(e.selected[0][i])/f.length,h=""+Math.max(1,Math.ceil(4*p));return[h,h];default:throw"Node type "+e.type+" does not have the token context."}}},w=new Map;try{var A=f[c[e.type]];try{for(var T=Z(A),N=T.next();!N.done;N=T.next()){var S=N.value;w.set(S,E[S](e))}}catch(e){l={error:e}}finally{try{N&&!N.done&&(s=T.return)&&s.call(T)}finally{if(l)throw l.error}}}catch(t){throw"Node type "+e.type+" not handled in nodeToDesc, threw: "+t}return w}(e,t,r,n,a,o)}(h,n,o,s,d,u),h}function te(e,t){var r,n,i,a=void 0;if("data"!==e.type)return a;try{for(var o=Z(e.tableKeys.entries()),l=o.next();!l.done;l=o.next()){var s=W(l.value,2),d=s[0],u=s[1];"facet"!==e.tableKeysMap[d]&&"quartile"!==e.tableKeysMap[d]&&u!==t.field&&("number"==typeof(i=""+e.selected[0][u])||!isNaN(i)&&!isNaN(parseFloat(i)))&&(a=u)}}catch(e){r={error:e}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}function re(e){var t,r;if("data"===e.type)return e;if(e.children)try{for(var n=Z(e.children),i=n.next();!i.done;i=n.next()){var a=i.value;if("data"===a.type)return a;var o=re(a);if(o)return o}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}}var ne=function(){return ne=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ne.apply(this,arguments)},ie=function(e){return ne(ne({},e),{type:"chart"})},ae=function(e){return ne(ne({},e),{type:"facetedChart"})};function oe(t,r){var n,l=X(t),p=document.createElement("div");if("table"===(r={renderType:(null==r?void 0:r.renderType)||"tree",onFocus:null==r?void 0:r.onFocus}).renderType)p.appendChild(function(e,t){var r=document.createElement("table"),n=document.createElement("thead"),a=document.createElement("tr");t.forEach((function(e){var t=document.createElement("th");t.setAttribute("scope","col"),t.innerText=e,a.appendChild(t)})),n.appendChild(a),r.appendChild(n);var o=document.createElement("tbody");return e.forEach((function(e){var r=document.createElement("tr");t.forEach((function(t){var n=document.createElement("td");n.innerText=i(e[t]),r.appendChild(n)})),o.appendChild(r)})),r.appendChild(o),r}(l.root.selected,l.fieldsUsed));else{var h=function(e){var t,r=localStorage.getItem("settingsData");r?t=JSON.parse(r):(t=v,localStorage.setItem("settingsData",JSON.stringify(v)));var n=document.createElement("fieldset");n.setAttribute("id","settings");var i=document.createElement("legend");i.setAttribute("tabindex","0"),i.innerText="Settings Menu",n.appendChild(i);var a=document.createElement("button");a.addEventListener("click",(function(e){n.dispatchEvent(new KeyboardEvent("keydown",{key:"Escape"}))})),a.innerText="Close",n.appendChild(a),Object.keys(t).forEach((function(t){n.appendChild(E(t,e));var r=function(e,t){var r,n,i,a,o=f[e],l=document.createElement("div");l.id=e+"-custom";var s=document.createElement("div");s.id=e+"-custom-options";var d=document.createElement("input");d.type="text",d.id=e+"-custom-name";var u=document.createElement("label");u.setAttribute("for",e+"-custom-name"),u.innerText="Custom preset name";try{for(var c=b(o),p=c.next();!p.done;p=c.next()){var h=p.value,v=document.createElement("select");v.id=e+"-"+h;try{for(var y=(i=void 0,b(["off","short","long"])),g=y.next();!g.done;g=y.next()){var x=g.value,T=document.createElement("option");T.innerText=x,T.value=x,v.appendChild(T)}}catch(e){i={error:e}}finally{try{g&&!g.done&&(a=y.return)&&a.call(y)}finally{if(i)throw i.error}}var N=document.createElement("label");N.setAttribute("for",e+"-"+h),N.innerText=m[h];var S=document.createElement("div");S.appendChild(v),S.appendChild(N),s.append(S)}}catch(e){r={error:e}}finally{try{p&&!p.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}var I=document.createElement("button");return I.innerText="Save",I.addEventListener("click",(function(r){!function(e,t){var r=document.getElementById(e+"-custom");r.setAttribute("style","display: none"),r.setAttribute("aria-hidden","true");var n=JSON.parse(localStorage.getItem("settingsData")),i=document.getElementById(e+"-custom-name").value;n[e][i]=A(e),localStorage.setItem("settingsData",JSON.stringify(n)),function(e){JSON.parse(localStorage.getItem("settingsData")),document.getElementById(e+"-verbosity-container").replaceWith(E(e,t))}(e);var a=document.getElementById(e+"-verbosity");a.value=i,w(a,t),a.focus(),a.setAttribute("aria-active","true");var o=document.getElementById("command-dropdown"),l=document.createElement("option");l.innerText=i,l.value=i,o.appendChild(l)}(e,t)})),l.append(s),l.appendChild(u),l.appendChild(d),l.appendChild(I),l}(t,e);r.setAttribute("style","display: none"),r.setAttribute("aria-hidden","true"),n.appendChild(r)}));var o=document.createElement("p");return o.innerText="Press escape to close the menu. Press ctrl-m to open it.",o.setAttribute("tabindex","0"),n.appendChild(o),n}(l);h.setAttribute("style","display: none"),h.setAttribute("aria-hidden","true"),p.appendChild(h);var x=function(){var t,r,n,i,a,o,l,s,c,f,p=document.createElement("select");function h(e,t,r){var n=document.createElement("option");n.innerText=e,n.value=t,r.appendChild(n)}p.setAttribute("id","command-dropdown");try{for(var m=b(d),v=m.next();!v.done;v=m.next())h(x=v.value,x,p)}catch(e){t={error:e}}finally{try{v&&!v.done&&(r=m.return)&&r.call(m)}finally{if(t)throw t.error}}try{for(var y=b(d),g=y.next();!g.done;g=y.next()){var x;h("focus "+(x=g.value),"focus-"+x,p)}}catch(e){n={error:e}}finally{try{g&&!g.done&&(i=y.return)&&i.call(y)}finally{if(n)throw n.error}}h("clear","clear",p);try{for(var E=b(Object.values(e)),w=E.next();!w.done;w=E.next()){var A=w.value;"string"==typeof A&&h(A,A,p)}}catch(e){a={error:e}}finally{try{w&&!w.done&&(o=E.return)&&o.call(E)}finally{if(a)throw a.error}}try{for(var T=b(u),N=T.next();!N.done;N=T.next()){var S=N.value;if("root"!==S){var I=JSON.parse(localStorage.getItem("settingsData"));try{for(var k=(c=void 0,b(Object.keys(I[S]))),C=k.next();!C.done;C=k.next()){var F=C.value;h(S.slice(0,1)+F,S+"-"+F,p)}}catch(e){c={error:e}}finally{try{C&&!C.done&&(f=k.return)&&f.call(k)}finally{if(c)throw c.error}}}}}catch(e){l={error:e}}finally{try{N&&!N.done&&(s=T.return)&&s.call(T)}finally{if(l)throw l.error}}var O=document.createElement("label");O.setAttribute("for","command-dropdown"),O.innerText="Choose command";var L=document.createElement("div");return L.setAttribute("id","command-dropdown-container"),L.appendChild(O),L.appendChild(p),L}();x.setAttribute("style","display: none"),x.setAttribute("aria-hidden","true"),p.appendChild(x);var S=function(e){var t,r=(Math.random()+1).toString(36).substring(7),n=e.root,i=document.createElement("ul"),a=r+"-"+n.type+"-label";return i.setAttribute("role","tree"),i.setAttribute("aria-labelledby",a),i.setAttribute("id","tree-root"),i.appendChild(function e(t,r,n,i,a,o){var l=document.createElement("li"),s=o+"-"+(i-1);l.setAttribute("role","treeitem"),l.setAttribute("aria-level",String(n)),l.setAttribute("aria-setsize",String(a)),l.setAttribute("aria-posinset",String(i)),l.setAttribute("aria-expanded","false"),l.setAttribute("data-nodetype",t.type),l.setAttribute("id",s),t.gridIndex&&(l.setAttribute("data-i",String(t.gridIndex.i)),l.setAttribute("data-j",String(t.gridIndex.j))),t.filterValue&&l.setAttribute("data-filterValue",JSON.stringify(t.filterValue));var d=document.createElement("span");if(d.textContent=N(t),l.appendChild(d),t.children.length){var u=t.children.filter((function(e){return"data"===e.type})),c=t.children.filter((function(e){return"data"!==e.type})),f=document.createElement("ul");f.setAttribute("role","group"),u.length?f.appendChild(_(u,n+1)):c.forEach((function(t,i,a){f.appendChild(e(t,r,n+1,i+1,a.length,s))})),l.appendChild(f)}return l}(n,r,1,1,1,"root")),null===(t=i.querySelector("span"))||void 0===t||t.setAttribute("id",a),i}(l),k=document.createElement("div");k.classList.add("olli-vis"),k.appendChild(S),p.appendChild(k);var C=new s(S,r.onFocus);C.init(),document.addEventListener("keypress",(function(e){"t"!==e.key||C.currentlyTypingToken()||C.setFocusToItem(C.rootTreeItem)})),function(e,t){e.addEventListener("keydown",(function(e){if("Escape"===e.key){var r=document.getElementById("settings");r.setAttribute("style","display: none"),r.setAttribute("aria-hidden","true"),setTimeout((function(){t.setFocusToItem(t.lastFocusedItem)}),0)}else if(e.altKey&&"ArrowLeft"===e.key){if((i=document.activeElement)&&"SELECT"===i.nodeName){var n=(a=i.parentNode).previousElementSibling;null!=n&&(a.insertAdjacentElement("afterend",n),i.focus(),i.setAttribute("aria-active","true"),g(I(A(i.id.split("-")[0]))))}}else if(e.altKey&&"ArrowRight"===e.key){var i;if((i=document.activeElement)&&"SELECT"===i.nodeName){var a,o=(a=i.parentNode).nextElementSibling;null!=o&&(a.parentNode.insertBefore(o,a),g(I(A(i.id.split("-")[0]))))}}}));var r=e.firstElementChild,n=e.lastElementChild;r.addEventListener("keydown",(function(e){"Tab"===e.key&&e.shiftKey&&e.preventDefault()})),n.addEventListener("keydown",(function(e){"Tab"!==e.key||e.shiftKey||e.preventDefault()}))}(h,C),S.addEventListener("keydown",(function(e){if(e.ctrlKey&&"m"===e.key){var t=document.getElementById("settings"),r=t.firstElementChild;t.setAttribute("style","display: block"),t.setAttribute("aria-hidden","false"),setTimeout((function(){r.focus(),r.setAttribute("aria-selected","true")}),0)}if(e.ctrlKey&&"i"===e.key){var n=document.getElementById("command-dropdown-container");n.setAttribute("style","display: block"),n.setAttribute("aria-hidden","false"),setTimeout((function(){n.firstElementChild.focus(),n.setAttribute("aria-selected","true")}),0)}})),function(t,r,n){t.addEventListener("keydown",(function(i){var a,o,l,s,f=JSON.parse(localStorage.getItem("settingsData"));if("Enter"===i.key){var p=t.children[1].selectedOptions[0].value;try{for(var h=y(d),m=h.next();!m.done;m=h.next()){var v=m.value;if(p===v){var b=R(n.lastFocusedItem.domNode,r);if(b.description.has(p)){var x=c[b.type],E=document.getElementById(x+"-verbosity").value,A=f[x][E].find((function(e){return e[0]===p}))[1];g(b.description.get(p)[A])}else g("No "+v+" available")}else p==="focus-"+v&&(T[v]=!0,J(r,document.getElementById("tree-root")))}}catch(e){a={error:e}}finally{try{m&&!m.done&&(o=h.return)&&o.call(h)}finally{if(a)throw a.error}}"clear"===p&&(d.forEach((function(e){T[e]=!1})),J(r,document.getElementById("tree-root"))),u.forEach((function(e){var t,n;if("root"!==e){var i=document.getElementById(e+"-verbosity"),a=Object.keys(f[e]);try{for(var o=y(a),l=o.next();!l.done;l=o.next()){var s=l.value;if(p===e+"-"+s)return i.value=s,w(i,r),void g(i.id.split("-")[0]+" verbosity set to "+i.value)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}}}));var S=function(t){if("string"!=typeof t)return"continue";var i=Number(Object.values(e).find((function(r){return"number"==typeof r&&e[r]===t}))),a=e[i];p===t&&g(N(R(n.lastFocusedItem.domNode,r),a))};try{for(var I=y(Object.values(e)),k=I.next();!k.done;k=I.next())S(k.value)}catch(e){l={error:e}}finally{try{k&&!k.done&&(s=I.return)&&s.call(I)}finally{if(l)throw l.error}}}"Enter"!==i.key&&"Escape"!==i.key||(t.setAttribute("style","display: none"),t.setAttribute("aria-hidden","true"),n.setFocusToItem(n.lastFocusedItem)),"Tab"===i.key&&i.preventDefault()}))}(x,l,C),n=C,o({treesOnPage:(a().treesOnPage||[]).concat([n])}),a().keyListenerAttached||(document.addEventListener("keydown",(function(e){if(!function(e){switch(null==e?void 0:e.nodeName){case"INPUT":case"TEXTAREA":case"SELECT":case"OPTION":return!0}return"string"==typeof(null==e?void 0:e.getAttribute("contenteditable"))}(document.activeElement)){var t=a(),r=t.lastVisitedTree,n=t.treesOnPage;if("KeyT"===e.code){var i=r||n[0];if("true"===i.domNode.firstElementChild.getAttribute("aria-selected")){var o=n.indexOf(i);if(e.shiftKey){if(o>0){var l=n[o-1];l.setFocusToItem(l.rootTreeItem)}}else if(o<n.length-1){var s=n[o+1];s.setFocusToItem(s.rootTreeItem)}}else i.setFocusToItem(i.rootTreeItem)}}})),o({keyListenerAttached:!0}))}return p}})(),n})()));